(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f33e4c72"],{"0e81":function(e,t,n){},2782:function(e,t,n){"use strict";n.r(t);n("e7e5");var r=n("d399"),a=n("1da1"),c=(n("a9e3"),n("96cf"),n("7a23")),u=n("3de1"),o=n("cc7f"),i=n("6779"),s=n("bae1"),l=n("214b"),p=n("f7fe"),b=n.n(p),f=n("3835"),d=(n("d3b7"),n("3ca3"),n("ddb0"),n("d4ec")),m=n("bee2"),v=n("c030"),j=n("ed1b"),O=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:j;Object(d["a"])(this,e),this.provider=t;var c=t.getSigner(n).connectUnchecked();this.contract=new v["a"].Contract(r,a,c)}return Object(m["a"])(e,[{key:"tokenSymbol",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.contract.symbol());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"tokenBalance",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.contract.balanceOf(t));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"tokenDecimal",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.contract.decimals());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"totalSupply",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.contract.totalSupply());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getAllowance",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.contract.allowance(t,n));case 1:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"approve",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.contract.approve(t,v["a"].constants.MaxUint256));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}();function h(e,t,n,r){return k.apply(this,arguments)}function k(){return k=Object(a["a"])(regeneratorRuntime.mark((function e(t,n,r,a){var c,u,o,s,l,p,b;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=new O(t.provider,t.account,n),e.next=3,Promise.all([c.getAllowance(r,a),c.tokenBalance(r),c.tokenDecimal(),c.tokenSymbol()]);case 3:return u=e.sent,o=Object(f["a"])(u,4),s=o[0],l=o[1],p=o[2],b=o[3],e.abrupt("return",{isApprove:!s.isZero(),balance:i["utils"].formatUnits(l,p),decimal:p,symbol:b});case 10:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}var w=function(e){return Object(c["pushScopeId"])("data-v-867f1bde"),e=e(),Object(c["popScopeId"])(),e},g={class:"container py-3"},x=w((function(){return Object(c["createElementVNode"])("div",{class:"font16 font-bold text-center mb-3 text-primary-0"},"-- 返奖配置 --",-1)})),y={class:"c-input-group c-input-group-box c-input-group-border"},R=w((function(){return Object(c["createElementVNode"])("div",null,"等级",-1)})),N={class:"c-input-group c-input-group-box c-input-group-border"},E=w((function(){return Object(c["createElementVNode"])("div",{class:"mt-2"},"返奖数量",-1)})),V={class:"c-input-group c-input-group-box c-input-group-border"},S={class:"flex flex-between mt-2"},B=["disabled"],A={setup:function(e){var t=Object(c["inject"])("chainInfo"),n=Object(c["ref"])(!1),p=Object(c["reactive"])({token:"",level:0,amount:""}),f=Object(c["ref"])({isApprove:!1,balance:0,decimal:0,symbol:""}),d=b()((function(){m()}),1e3),m=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Object(l["b"])(p.token)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,h(t,p.token,t.account,s["a"].NodeAddress);case 4:f.value=e.sent;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l["a"])(t,p.token,s["a"].NodeAddress);case 3:return n=e.sent,Object(r["a"])("授权中..."),e.next=7,n.wait();case 7:return e.next=9,m();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),Object(r["a"])(e.t0.data.message||e.t0.data||e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Object(u["b"])(p.level)&&!(Number(p.level)<0)){e.next=3;break}return Object(r["a"])("请输入有效等级"),e.abrupt("return");case 3:if(Object(u["b"])(p.amount)&&!(Number(p.amount)<0)){e.next=6;break}return Object(r["a"])("请输入有效数量"),e.abrupt("return");case 6:if(!(Number(f.value.balance)<Number(p.amount))){e.next=9;break}return Object(r["a"])("余额不足"),e.abrupt("return");case 9:return e.prev=9,e.next=12,Object(o["c"])(t,p.token,p.level,i["utils"].parseUnits(p.amount,f.value.decimal));case 12:return n=e.sent,Object(r["a"])("交易已提交, 等待链上确认"),p.token="",p.amount="",e.next=18,n.wait();case 18:Object(r["a"])("操作成功"),e.next=24;break;case 21:e.prev=21,e.t0=e["catch"](9),Object(r["a"])(e.t0.data.message||e.t0.data||e.t0);case 24:case"end":return e.stop()}}),e,null,[[9,21]])})));return function(){return e.apply(this,arguments)}}();return Object(c["watchEffect"])((function(){})),function(e,t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",g,[Object(c["createElementVNode"])("div",{onClick:t[0]||(t[0]=function(t){return e.$router.back()})},"<<返回"),x,Object(c["createElementVNode"])("div",null,"Token ("+Object(c["toDisplayString"])(f.value["symbol"]||"--")+")",1),Object(c["createElementVNode"])("div",y,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"px-2","onUpdate:modelValue":t[1]||(t[1]=function(e){return Object(c["unref"])(p).token=e}),onInput:t[2]||(t[2]=function(){return Object(c["unref"])(d)&&Object(c["unref"])(d).apply(void 0,arguments)})},null,544),[[c["vModelText"],Object(c["unref"])(p).token]])]),R,Object(c["createElementVNode"])("div",N,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"px-2","onUpdate:modelValue":t[3]||(t[3]=function(e){return Object(c["unref"])(p).level=e})},null,512),[[c["vModelText"],Object(c["unref"])(p).level]])]),E,Object(c["createElementVNode"])("div",V,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"px-2","onUpdate:modelValue":t[4]||(t[4]=function(e){return Object(c["unref"])(p).amount=e})},null,512),[[c["vModelText"],Object(c["unref"])(p).amount]])]),Object(c["createElementVNode"])("div",S,[f.value["isApprove"]?(Object(c["openBlock"])(),Object(c["createElementBlock"])("button",{key:1,class:"primary-btn primary-btn-blue w-100",onClick:j},"确认设置")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("button",{key:0,disabled:!Object(c["unref"])(p).token||n.value,class:"primary-btn primary-btn-blue w-100",onClick:v},"授权 "+Object(c["toDisplayString"])(f.value["symbol"]),9,B))])])}}},D=(n("7a18"),n("6b0d")),U=n.n(D);const I=U()(A,[["__scopeId","data-v-867f1bde"]]);t["default"]=I},"7a18":function(e,t,n){"use strict";n("0e81")}}]);